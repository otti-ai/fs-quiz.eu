<!doctype html>
<html lang="en">
  <head>
	<!-- ICONS-->
	<link rel="apple-touch-icon" sizes="57x57" href="img/icons/favicon/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="img/icons/favicon/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="img/icons/favicon/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="img/icons/favicon/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="img/icons/favicon/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="img/icons/favicon/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="img/icons/favicon/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="img/icons/favicon/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="img/icons/favicon/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="img/icons/favicon/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="img/icons/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="img/icons/favicon/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="img/icons/favicon/favicon-16x16.png">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="img/icons/favicon/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<base href="https://fs-quiz.eu/">         <!--  https://fs-quiz.eu/ -->
    <!-- Bootstrap -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
	<script src="./js/bootstrap.min.js"></script>

	
    <title>FS-Quiz - Testquiz 2025</title>
  </head>
  <body class="d-flex flex-column min-vh-100"> 

 

  <!-- Navigation -->
	<header class="p-3 bg-dark text-white">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<div class="container-fluid col-lg-8">
				<a class="navbar-brand" href="https://quiz.fs-quiz.eu">FS-Quiz</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarTogglerDemo01">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0">
						
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li class="nav-item"><a target="_blank" href="https://github.com/otti-ai/fs-quiz.eu"><img src="/img/icons/github.svg" alt="Github Logo" width="25" height="25" style="filter: invert(1);" class="d-inline-block align-text-center"></a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>

    <div class="container container-md d-flex align-items-center justify-content-center p-3" style="min-height: 80vh;">
        <!-- Loading -->
        <div style="display:block;" id="loader" class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>

        <!-- Start -->
        <div style="display:none; width: 100%; max-width: 800px;" id="infoBody">
            <img class="d-none d-sm-block" style="position: relative; height: 60px; top: -40px; z-index: 100; margin-bottom: -60px; float: right;" src="https://quiz.fs-quiz.eu/cat.png">
            <div id="bodyStart" class="card text-center">
                <div class="row g-0">
                    <div class="col-md-4 d-none d-sm-none d-md-block">
                        <img style="object-fit: cover; height: 100%;" src="https://quiz.fs-quiz.eu/fred.png" class="img-fluid rounded-start" alt="FSG Fred">
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <h5 class="card-title">FS-Quiz Testquiz 2025</h5>
                            <p class="text-start">
                                Since last year's test quiz was so well received, there will be another one this year. The test quiz will
                                take place on the <strong>24th of January at 16:00 CET</strong>. <br><br>
                                The quiz will consist of new questions in the style of typical registration questions. The questions must be 
                                answered one after the other in a given time. The number of correct answers is more important than the total 
                                time. The ranking list and the correct answers will be published shortly after the quiz.<br> The quiz will take about <strong>45 minutes</strong>.<br><br>
                                To take part in the quiz, <strong>you must first register your team</strong>. This is possible until shortly before the quiz.<br><br>

                                In case of problems: info@fs-quiz.eu
                            </p>
                            <hr>
                            <div id="notLoginContainer">
                                <button onclick="openLogin()" type="button" class="btn btn-primary">Log in</button>
                                <button onclick="openRegistration()" type="button" class="btn btn-primary" >Sign up</button>
                            </div>
                            <div id="loginContainer">
                                <h4>You are successfully logged in!</h4>
                                <p>Waiting for quiz start</p>
                                <p>Quiz will starts automatically.<br><strong>You do not need to reload the page!</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="time" class="card-footer text-muted"></div>
            </div>
        </div>
        <!-- Successfull registration -->
        <div style="display:none; width: 100%; max-width: 600px;" id="regSuccesBody">
            <div id="bodyStart" class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">Successfull</h5>
                    <p class="text-start">
                        Your team is now registered for the test quiz.<br>
                        lease make sure to log in before the quiz begins to access and answer the questions.
                    </p>
                    <hr>
                    <button onclick="openStart()" type="button" class="btn btn-primary">Back</button>
                </div>
            </div>
        </div>
        <!-- Login -->
        <div style="display:none; width: 100%; max-width: 400px;" id="loginBody">
            <div id="bodyStart" class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">Log in</h5>
                    <form onsubmit="return false">
                        <div class="form-floating" style="margin-bottom: -1px">
                            <input required type="email" class="form-control" id="floatingEmail" placeholder="name@example.com" style="border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                            <label for="floatingEmail">Email address</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input required type="password" class="form-control" id="floatingPassword" placeholder="Password" style="border-top-right-radius: 0; border-top-left-radius: 0;">
                            <label for="floatingPassword">Password</label>
                        </div>
                        <p id="error-login" class="text-danger text-start"></p>
                        <button onclick="logins()" type="submit" class="btn btn-primary mt-2">Log in</button>
                    </form>
                </div>
                <div id="" class="card-footer text-muted">Don't have an account? <a onclick="openRegistration(); return false;" href="#">Sign up</a></div>
            </div>
        </div>
        <!-- Registration -->
        <div style="display:none; width: 100%; max-width: 400px;" id="registrationBody">
            <div id="bodyStart" class="card text-center">
                <div class="card-body">
                    <h5 class="card-title">Sign up</h5>
                    <form onsubmit="return false">
                        <div class="form-floating" style="margin-bottom: -1px">
                            <input required type="text" class="form-control" id="floatingNameReg" placeholder="Team FS-Quiz" style="border-bottom-right-radius: 0; border-bottom-left-radius: 0;">
                            <label for="floatingNameReg">Teamname</label>
                        </div>
                        <div class="form-floating" style="margin-bottom: -1px">
                            <input required type="email" class="form-control" id="floatingEmailReg" placeholder="name@example.com" style="border-bottom-right-radius: 0; border-bottom-left-radius: 0; border-top-right-radius: 0; border-top-left-radius: 0;">
                            <label for="floatingEmailReg">Email address</label>
                        </div>
                        <div class="form-floating" style="margin-bottom: -1px">
                            <input required type="password" class="form-control" id="floatingPasswordReg" placeholder="Password" style="border-bottom-right-radius: 0; border-bottom-left-radius: 0; border-top-right-radius: 0; border-top-left-radius: 0;">
                            <label for="floatingPasswordReg">Password</label>
                        </div>
                        <div class="form-floating mb-3" style="margin-bottom: -1px">
                            <input required type="password" class="form-control" id="floatingPasswordconReg" placeholder="Password" style="border-top-right-radius: 0; border-top-left-radius: 0;">
                            <label for="floatingPasswordconReg">Confirm Password</label>
                        </div>
                        <p id="error-reg" class="text-danger text-start"></p>
                        <button onclick="registrations()" type="submit" class="btn btn-primary">Sign up</button>
                    </form>
                </div>
                <div id="" class="card-footer text-muted">Do you have an account? <a onclick="openLogin(); return false;" href="#">Log in</a></div>
            </div>
        </div>
        <!-- Quiz Body -->
        <div style="display:none; width: 100%; max-width: 900px;" id="quizbody">
            <div id="bodyStart" class="card text-center">
                <div class="card-body">
                    <h5 id="questionTitle" class="card-title"></h5>
                    <p id="questionText" class="text-start">
                    </p>
                    <hr>
                    <div id="questionAnswers">
                    </div>
                </div>
                <div id="time2" class="card-footer text-muted"></div>
            </div>
        </div>
    </div>
 <script> 
	setup();
    //bodys
    var regBody = document.getElementById("registrationBody");
    var loginBody = document.getElementById("loginBody");
    var infoBody = document.getElementById("infoBody");
    var regSuccesBody = document.getElementById("regSuccesBody");
    var loader = document.getElementById("loader");
    var quizbody = document.getElementById("quizbody");

    var questionTitle = document.getElementById("questionTitle");
    var questionText = document.getElementById("questionText");
    var questionAnswers = document.getElementById("questionAnswers");

    var resultSend = true;
    var reload;
    var loginToken;
    var questionId;

    var timeDisplay = document.getElementById("time");
    var timeDisplayQuiz = document.getElementById("time2");
    var counteInterval;
    var endtime;
    var quizstart= 1737730800;
    var isQuizStart = false;
    var isTimeOver = false;
    

    function openLogin(){
        infoBody.style.display = "none";
        regBody.style.display = "none";
        loginBody.style.display = "block";
    }

    async function openRanking(){
        quizbody.style.display = "none";
        infoBody.style.display = "none";
        loader.style.display = "block";
        let response =  await fetch("https://quiz.fs-quiz.eu/ranking.php");//https://quiz.fs-quiz.eu
        let text = await response.text();
        quizbody.style.display = "block";
        loader.style.display = "none";
        questionAnswers.innerHTML = '';
        questionTitle.innerHTML = 'Ranking';
        questionText.innerHTML = text;
        timeDisplayQuiz.innerHTML = "Ranking";
    }

    async function sendAnswer(answer){
        loader.style.display = "block";
        quizbody.style.display = "none";
        let respons = await fetch("https://quiz.fs-quiz.eu/setAnswer.php?id="+loginToken+"&question="+questionId+"&result="+answer.trim());//https://quiz.fs-quiz.eu
        let text = await respons.text();
        switch(text) {
            case "error":
                //antwort bereits gesetzt
                break;
            case "ok":
                loader.style.display = "none";
                quizbody.style.display = "block";
                console.log(answer);
                resultSend = true;
                setCookie('resultSend','true');
                showWaitForNextQuestion();
                if(isTimeOver){
                    getStatus();
                }
                break;
            default:
                //andere fehler
        }
    }

    function showWaitForNextQuestion(){
        questionAnswers.innerHTML = '';
        questionTitle.innerHTML = 'Waiting for the next question';
        questionText.innerHTML = 'The next question will be loaded automatically.<br><strong>You do not need to reload the page!</strong>';
    }

    function openRegistration(){
        infoBody.style.display = "none";
        loginBody.style.display = "none";
        regBody.style.display = "block";
    }

    function openStart(){
        regSuccesBody.style.display = "none";
        infoBody.style.display = "block";
    }

    function isLogin(){
        if(loginToken){
            document.getElementById("notLoginContainer").style.display = "none";
            document.getElementById("loginContainer").style.display = "block";
        }else{
            document.getElementById("notLoginContainer").style.display = "block";
            document.getElementById("loginContainer").style.display = "none";
        }
    }

    function setup(){
        endtime = quizstart;
        loginToken = getCookie('loginToken');
        if(getCookie('resultSend') === 'true'){
            resultSend = true;
            reload = true;
            console.log('Reload set');
        }else{
            resultSend = false;
            reload = false;
        }
        getStatus();
    }

    async function getStatus() {
        let result = await fetch("https://quiz.fs-quiz.eu/quiz.php"); //https://quiz.fs-quiz.eu
        let text = await result.text();
        let json = JSON.parse(text);
        if(loginToken){
            switch(json.status) {
                case "wait":
                    endtime = json.end;
                    loader.style.display = "none";
                    infoBody.style.display = "block";
                    isLogin();
                    timeCounter();
                    counteInterval = setInterval(timeCounter, 1000);
                    break;
                case "end":
                    getTeamResult();
                    break;
                default:
                    endtime = json.end;
                    isQuizStart = true;
                    resultSend = false;
                    isTimeOver = false;
                    setCookie('resultSend','false');
                    questionTitle.innerHTML = 'Question ' + json.status;
                    questionId = json.status;
                    questionText.innerHTML = json.question;
                    questionAnswers.innerHTML = json.answers;
                    infoBody.style.display = "none";
                    loader.style.display = "none";
                    quizbody.style.display = "block";
                    if(reload){
                        resultSend = true;
                        showWaitForNextQuestion();
                        console.log('Reload to');
                        setCookie('resultSend','true');
                        reload = false;
                    }
                    timeCounter();
                    counteInterval = setInterval(timeCounter, 1000);
            }
        }else{
            loader.style.display = "none";
            infoBody.style.display = "block";
            isLogin();
            timeCounter();
            counteInterval = setInterval(timeCounter, 1000);
        }
    }

    async function getTeamResult() {
        quizbody.style.display = "none";
        infoBody.style.display = "none";
        loader.style.display = "block";
        clearInterval(counteInterval);
        let response =  await fetch("https://quiz.fs-quiz.eu/result.php?token="+loginToken);//https://quiz.fs-quiz.eu
        let text = await response.text();
        quizbody.style.display = "block";
        loader.style.display = "none";
        questionAnswers.innerHTML = '';
        questionTitle.innerHTML = 'Result';
        questionText.innerHTML = text;
        timeDisplayQuiz.innerHTML = '<a onclick="openRanking(); return false;" href="#">Open Ranking</a>';
    }

    async function logins() {
        let email = document.getElementById("floatingEmail").value;
        let pass = document.getElementById("floatingPassword").value;
        if(email == "" || pass == ""){ return;}

        loginBody.style.display = "none";
        loader.style.display = "block";
        let regist = await fetch("https://quiz.fs-quiz.eu/login.php?email="+email+"&passwort="+pass);//https://quiz.fs-quiz.eu
        let text = await regist.text();
        if(text == "error"){
            loader.style.display = "none";
            loginBody.style.display = "block";
            document.getElementById("error-login").innerHTML = "Invalid";
        }else{
            loader.style.display = "none";
            infoBody.style.display = "block";
            loginToken = text;
            setCookie('loginToken',text);
        }
        getStatus();
    }

    async function registrations() {
        let teamname = document.getElementById("floatingNameReg").value;
        let email = document.getElementById("floatingEmailReg").value;
        let pass = document.getElementById("floatingPasswordReg").value;
        let pass2 = document.getElementById("floatingPasswordconReg").value;
        if(teamname == "" || email == "" || pass == "" || pass2 == ""){ return;}
        if(pass != pass2){
            document.getElementById("error-reg").innerHTML = "Password not the same";
            return;
        }

        loader.style.display = "block";
        regBody.style.display = "none";
        let regist = await fetch("https://quiz.fs-quiz.eu/registration.php?teamname="+teamname+"&email="+email+"&passwort="+pass); //https://quiz.fs-quiz.eu
        let text = await regist.text();
        if(text == "ok"){
            loader.style.display = "none";
            regSuccesBody.style.display = "block";
        }
        if(text == "error"){
            loader.style.display = "none";
            regBody.style.display = "block";
            document.getElementById("error-reg").innerHTML = "Invalid or duplicate";
        }
        isLogin();
    }

    function guestionTimeOver(){
        if(isTimeOver){return;}
        isTimeOver = true;
        if(!resultSend && isQuizStart){
            sendAnswer('');
            console.log('time over');
        }else{
            getStatus();
        }
    }

    function timeCounter(){
        if(isTimeOver){return;}
        var now = new Date().getTime();
        var distanceTime = quizstart*1000 - now;
        if(loginToken){
            distanceTime = endtime*1000 - now;
        }
        
        // Time up
        if(distanceTime<=0 && loginToken){
            clearInterval(counteInterval);
            guestionTimeOver();
        }

        // Time
        var timeString = timeToSting(distanceTime);

        // Display 
        if(distanceTime<60){
            timeDisplayQuiz.style.color = "red";
            timeDisplay.style.color = "red";
        }else{
            timeDisplayQuiz.style.color = "black";
        }
        if(distanceTime>0){
            timeDisplay.innerHTML = "Quiz starts in: "+timeString;
            timeDisplayQuiz.innerHTML = "Next question in: "+timeString;
        }else{
            timeDisplayQuiz.innerHTML = "Next question available";
            timeDisplay.innerHTML = "Quiz has started";
        }
    }

    function timeToSting(timeInSec) {
        var timeString = '';
        var days = Math.floor(timeInSec / (1000 * 60 * 60 * 24));
        var hours = Math.floor((timeInSec % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        var minutes = Math.floor((timeInSec % (1000 * 60 * 60)) / (1000 * 60));
        var seconds = Math.floor((timeInSec % (1000 * 60)) / 1000);

        if (hours   < 10) {hours   = "0"+hours;}
        if (minutes < 10) {minutes = "0"+minutes;}
        if (seconds < 10) {seconds = "0"+seconds;}

        if (days > 0) {timeString += days+'d ';}
        if (hours != "00" || days > 0) {timeString += hours+'h ';}
        
        return timeString+minutes+'m '+seconds+'s';
    }

    //cookie
    function setCookie(cname, cvalue) {
        const d = new Date();
        d.setTime(d.getTime() + (6*60*60*1000)); // 6 hours
        let expires = "expires="+ d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    function getCookie(cname) {
        let name = cname + "=";
        let decodedCookie = decodeURIComponent(document.cookie);
        let ca = decodedCookie.split(';');
        for(let i = 0; i <ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) == ' ') {
            c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
            }
        }
        return "";
    }

    </script>
    <footer class="footer mt-auto bg-light">
        <div class="col-lg-8 mx-auto p-3 text-dark">
        
        <div class="row justify-content-md-center">
        <div class="col-md-auto text-muted">
            <a>Created by Yannik Ottens · © 2025</a>
          </div>
        </div>
        </div>
      </footer>
       </body>
      </html>